/**
 * Canvas Fingerprinting Module
 * Use canvas fingerprinting to track and identify users
 */

export interface CanvasFingerprintVulnerability {
  type: string;
  issue: string;
  severity: 'low' | 'medium' | 'high' | 'critical';
  description: string;
}

export class CanvasFingerprinter {
  generateFingerprint(): string {
    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    if (ctx) {
      ctx.textBaseline = 'top';
      ctx.font = '14px Arial';
      ctx.textBaseline = 'alphabetic';
      ctx.fillStyle = '#f60';
      ctx.fillRect(125, 1, 62, 20);
      ctx.fillStyle = '#069';
      ctx.fillText('Canvas fingerprint', 2, 15);
      return canvas.toDataURL();
    }
    return '';
  }

  scanCanvasFingerprinting(): CanvasFingerprintVulnerability[] {
    const vulnerabilities: CanvasFingerprintVulnerability[] = [];
    
    const canvases = document.querySelectorAll('canvas');
    if (canvases.length > 0) {
      vulnerabilities.push({
        type: 'Canvas',
        issue: 'Canvas elements detected',
        severity: 'low',
        description: 'Canvas elements can be used for fingerprinting',
      });
    }
    
    return vulnerabilities;
  }
}

